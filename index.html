<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean Sound Mixer</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tone.js for web audio -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for a better look and feel */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0a192f;
            background-image: linear-gradient(180deg, #0a192f 0%, #172a46 100%);
            color: #e6f1ff;
        }

        .sound-pad {
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 2px solid transparent;
        }

        .sound-pad.playing {
            transform: scale(1.05);
            box-shadow: 0 0 25px 5px var(--glow-color, #00ffff);
            border-color: var(--glow-color, #00ffff);
        }
        
        /* Custom styles for volume sliders */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 80%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            outline: none;
            transition: opacity .2s;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #ffffff;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid var(--glow-color, #00ffff);
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #ffffff;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid var(--glow-color, #00ffff);
        }

        .control-btn {
             transition: all 0.2s ease-in-out;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <div id="start-screen" class="fixed inset-0 bg-black bg-opacity-70 flex flex-col items-center justify-center z-50 backdrop-blur-sm">
        <div class="text-center p-8 bg-gray-800 bg-opacity-50 rounded-2xl shadow-lg">
            <h1 class="text-5xl font-bold text-white mb-4">Welcome to the Ocean Sound Mixer</h1>
            <p id="start-message" class="text-xl text-gray-300 mb-8">Click below to load the audio files and dive in.</p>
            <button id="start-button" class="bg-cyan-500 hover:bg-cyan-400 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-wait">
                Start Listening
            </button>
        </div>
    </div>

    <main id="app-content" class="container mx-auto text-center opacity-0 transition-opacity duration-1000">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-4xl md:text-6xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-teal-200">
                Marine Soundscape
            </h1>
            <p class="text-lg md:text-xl text-cyan-100 mt-2">Click on an animal to play its sound. Mix them to create your own ocean symphony.</p>
        </header>

        <!-- Global Controls Removed -->

        <!-- Sound Grid -->
        <div id="sound-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
            <!-- Sound pads will be generated by JavaScript -->
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startScreen = document.getElementById('start-screen');
            const startButton = document.getElementById('start-button');
            const startMessage = document.getElementById('start-message');
            const appContent = document.getElementById('app-content');
            const grid = document.getElementById('sound-grid');

            let isAudioReady = false;

            // --- Marine Animal Sound Data ---
            // IMPORTANT: Replace the 'filePath' values with the actual paths to your sound files.
            // For example, if you have a folder named 'audio' next to your index.html,
            // the path would be 'audio/your-file-name.mp3'.
            const sounds = [
                { name: 'Arabian Humpback', emoji: '🐋', color: '#3b82f6', filePath: 'Arabian_sea_whale.mp3' },
                { name: 'False Killer Whale', emoji: '🐳', color: '#60a5fa', filePath: 'false_killer_whale.mp3' },
                { name: 'Spotted Dolphin', emoji: '🐬', color: '#22d3ee', filePath: 'panatropicalspotteddolphin.mp3' },
                { name: 'Irrawaddy Dolphin', emoji: '💧', color: '#60a5fa', filePath: 'Irrawadydolphin.mp3' },
                { name: 'Pilot Whale', emoji: '⚫', color: '#4b5577', filePath: 'short_finned_pilot_whales.mp3' },
                { name: 'Bottlenose Clicks', emoji: '🔊', color: '#34d399', filePath: 'bottlenoseclicks_filtered.mp3' },
                { name: 'Ocean Waves', emoji: '🌊', color: '#a78bfa', filePath: 'wave2_amp10x.mp3' },
                { name: 'Snapping Shrimp', emoji: '🦐', color: '#f87171', filePath: 'Snapping_shrimp_night_chorus.mp3' },
                { name: 'Spinner Dolphin', emoji: '🔄', color: '#22d3ee', filePath: 'spinnerdolphinwhistles.mp3' },
                { name: 'Blue Whale', emoji: '🐋', color: '#fb923c', filePath: 'Blue_whale.mp3' },
                { name: 'Ship Horn', emoji: '🚢', color: '#34d399', filePath: 'ship_horn.mp3' },
                { name: 'Dusk Fish Sound', emoji: '🐟', color: '#60a5fa', filePath: 'duskfishsound2_amp10x.mp3' },
            ];
            
            // --- Sound Loading Function ---
            async function loadSounds() {
                return new Promise((resolve) => {
                    const players = {};
                    sounds.forEach(sound => {
                        players[sound.name] = new Tone.Player({
                            url: sound.filePath,
                            loop: true,
                        }).toDestination();
                    });

                    // Wait for all players to load
                    Tone.loaded().then(() => {
                         // Attach the loaded players back to the sounds array
                        sounds.forEach(sound => {
                            const player = players[sound.name];
                            sound.player = player;
                            // For consistency with the old code structure
                            sound.synth = player; 
                            sound.loop = player;
                        });
                        resolve();
                    });
                });
            }

            // --- UI Generation ---
            function createPad(sound, index) {
                const pad = document.createElement('div');
                pad.classList.add('sound-pad', 'bg-slate-800', 'p-4', 'rounded-xl', 'flex', 'flex-col', 'items-center', 'justify-between', 'cursor-pointer', 'select-none');
                pad.style.setProperty('--glow-color', sound.color);
                pad.dataset.index = index;
                pad.innerHTML = `
                    <div class="text-4xl md:text-5xl mb-2">${sound.emoji}</div>
                    <div class="text-sm md:text-base font-semibold text-center">${sound.name}</div>
                    <input type="range" min="-40" max="6" value="0" class="mt-4 volume-slider">
                `;
                grid.appendChild(pad);

                const slider = pad.querySelector('.volume-slider');
                
                // Stop propagation to prevent pad click when using slider
                slider.addEventListener('mousedown', (e) => e.stopPropagation());
                slider.addEventListener('touchstart', (e) => e.stopPropagation());
                slider.addEventListener('click', (e) => e.stopPropagation());

                slider.addEventListener('input', (e) => {
                    if (sound.synth) {
                       sound.synth.volume.value = e.target.value;
                    }
                });

                pad.addEventListener('click', () => {
                    toggleSound(pad, sound);
                });
            }

            function toggleSound(pad, sound) {
                if (!isAudioReady || !sound.loop) return;
                
                if (pad.classList.contains('playing')) {
                    sound.loop.stop();
                    pad.classList.remove('playing');
                } else {
                    sound.loop.start(0);
                    pad.classList.add('playing');
                }
            }

            // --- Initialize App ---
            function init() {
                sounds.forEach((sound, index) => {
                    createPad(sound, index);
                });
            }

            // --- Start Audio Context & Load Files ---
            startButton.addEventListener('click', async () => {
                startButton.disabled = true;
                startButton.textContent = 'Loading Sounds...';
                startMessage.textContent = 'Please wait, the ocean is waking up...';

                await Tone.start();
                await loadSounds();
                
                isAudioReady = true;
                await Tone.Transport.start();
                console.log('Audio context started and files loaded');

                // Initialize volume from sliders
                document.querySelectorAll('.sound-pad').forEach(pad => {
                    const sound = sounds[pad.dataset.index];
                    const slider = pad.querySelector('.volume-slider');
                    if (sound.synth) {
                        sound.synth.volume.value = slider.value;
                    }
                });
                
                startScreen.style.opacity = 0;
                setTimeout(() => startScreen.style.display = 'none', 500);
                appContent.style.opacity = 1;
            });
            
            init();
        });
    </script>
</body>
</html>

